{:paths ["." "scripts"]
 :deps {io.github.babashka/sci.nrepl {:mvn/version "0.0.2"}
        org.babashka/cli {:mvn/version "0.2.23"}
        babashka/fs {:mvn/version "0.5.22"}
        org.clojure/data.json {:mvn/version "2.4.0"}}
 :tasks
 {:requires ([babashka.cli :as cli]
             [start-nrepl]
             [tasks])

  browser-nrepl {:doc "Start browser nREPL"
                 :task (start-nrepl/browser-nrepl (cli/parse-opts *command-line-args*
                                                                  {:coerce {:nrepl-port :int
                                                                            :websocket-port :int}}))}

  bundle-scittle {:doc "Download Scittle and nREPL plugin to src/vendor"
                  :task (tasks/bundle-scittle)}

  build {:doc "Build extension for all browsers (or specify one or more of: chrome, firefox, safari)"
         :task (apply tasks/build *command-line-args*)}

  build:chrome {:doc "Build extension for Chrome"
                :task (tasks/build "chrome")}

  build:firefox {:doc "Build extension for Firefox"
                 :task (tasks/build "firefox")}

  build:safari {:doc "Build extension for Safari"
                :task (tasks/build "safari")}

  dev {:doc "Start Squint watch and Vite dev server"
       :task (babashka.process/shell "npx squint watch & npx vite")}

  watch {:doc "Start Squint watch mode"
         :task (babashka.process/shell "npx squint watch")}

  publish {:doc "Publish new version: bump version, update changelog, commit, tag, push"
           :task (tasks/publish)}}}